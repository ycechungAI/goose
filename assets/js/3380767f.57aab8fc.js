"use strict";(self.webpackChunkgoose=self.webpackChunkgoose||[]).push([[4229],{47528:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"tutorials/lead-worker","title":"Lead/Worker Multi-Model Setup","description":"Enable multi-modal functionality by pairing LLMs to complete your tasks","source":"@site/docs/tutorials/lead-worker.md","sourceDirName":"tutorials","slug":"/tutorials/lead-worker","permalink":"/goose/docs/tutorials/lead-worker","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"description":"Enable multi-modal functionality by pairing LLMs to complete your tasks"},"sidebar":"tutorialSidebar","previous":{"title":"Observability with Langfuse","permalink":"/goose/docs/tutorials/langfuse"},"next":{"title":"Goose Recipes","permalink":"/goose/docs/tutorials/recipes-tutorial"}}');var t=n(74848),r=n(28453);const i={description:"Enable multi-modal functionality by pairing LLMs to complete your tasks"},a="Lead/Worker Multi-Model Setup",l={},d=[{value:"Turn-Based System",id:"turn-based-system",level:2},{value:"Quick Example",id:"quick-example",level:2},{value:"Configuration",id:"configuration",level:2},{value:"What Counts as a Failure?",id:"what-counts-as-a-failure",level:2},{value:"Reasons to Use Lead/Worker",id:"reasons-to-use-leadworker",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Planning Mode Compatibility",id:"planning-mode-compatibility",level:2}];function c(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"leadworker-multi-model-setup",children:"Lead/Worker Multi-Model Setup"})}),"\n",(0,t.jsx)(s.p,{children:"Goose supports a lead/worker model configuration that lets you pair two different AI models - one that's great at thinking and another that's fast at doing. This setup tackles a major pain point: premium models are powerful but expensive, while cheaper models are faster but can struggle with complex tasks. With lead/worker mode, you get the best of both worlds."}),"\n",(0,t.jsx)(s.p,{children:'The lead/worker model is a smart hand-off system. The "lead" model (think: GPT-4 or Claude Opus) kicks things off, handling the early planning and big picture reasoning. Once the direction is set, Goose hands the task over to the "worker" model (like GPT-4o-mini or Claude Sonnet) to carry out the steps.'}),"\n",(0,t.jsx)(s.p,{children:"If things go sideways (e.g. the worker model gets confused or keeps making mistakes), Goose notices and automatically pulls the lead model back in to recover. Once things are back on track, the worker takes over again."}),"\n",(0,t.jsx)(s.h2,{id:"turn-based-system",children:"Turn-Based System"}),"\n",(0,t.jsxs)(s.p,{children:["A ",(0,t.jsx)(s.strong,{children:"turn"})," is one full interaction - your prompt and the model's response. Goose switches models based on turns:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Initial turns"})," (default: 3) go to the lead model"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Subsequent turns"})," use the worker model"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Fallback kicks in"})," if the worker model fails too many times in a row"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Recovery"})," returns the session to the worker model once things stabilize"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"quick-example",children:"Quick Example"}),"\n",(0,t.jsx)(s.p,{children:"You might configure Goose like this:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'export GOOSE_LEAD_MODEL="gpt-4o"          # strong reasoning\nexport GOOSE_MODEL="gpt-4o-mini"          # fast execution\nexport GOOSE_PROVIDER="openai"\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Goose will start with ",(0,t.jsx)(s.code,{children:"gpt-4o"})," for the first three turns, then hand off to ",(0,t.jsx)(s.code,{children:"gpt-4o-mini"}),". If the worker gets tripped up twice in a row, Goose temporarily switches back to the lead model for two fallback turns before trying the worker again."]}),"\n",(0,t.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsxs)(s.p,{children:["Ensure you have ",(0,t.jsx)(s.a,{href:"/docs/getting-started/providers",children:"added the LLMs to Goose"})]})}),"\n",(0,t.jsx)(s.p,{children:"The only required setting is:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'export GOOSE_LEAD_MODEL="gpt-4o"\n'})}),"\n",(0,t.jsxs)(s.p,{children:["That's it. Goose treats your regular ",(0,t.jsx)(s.code,{children:"GOOSE_MODEL"})," as the worker model by default."]}),"\n",(0,t.jsx)(s.p,{children:"If you want more control, here are the optional knobs:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'export GOOSE_LEAD_PROVIDER="anthropic"         # If different from the main provider\nexport GOOSE_LEAD_TURNS=5                      # Use lead model for first 5 turns\nexport GOOSE_LEAD_FAILURE_THRESHOLD=3          # Switch back to lead after 3 failures\nexport GOOSE_LEAD_FALLBACK_TURNS=2             # Use lead model for 2 turns before retrying worker\n'})}),"\n",(0,t.jsx)(s.p,{children:"After making these configurations, the lead/worker models will be used in new CLI and Desktop sessions."}),"\n",(0,t.jsx)(s.h2,{id:"what-counts-as-a-failure",children:"What Counts as a Failure?"}),"\n",(0,t.jsx)(s.p,{children:"Goose is smart about detecting actual task failures, not just API errors. The fallback kicks in when the worker:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Generates broken code (syntax errors, tool failures, missing files)"}),"\n",(0,t.jsx)(s.li,{children:"Hits permission issues"}),"\n",(0,t.jsx)(s.li,{children:'Gets corrected by the user ("that\'s wrong", "try again", etc.)'}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Meanwhile, technical hiccups like timeouts, auth issues, or service downtime don't trigger fallback mode. Goose just retries those quietly."}),"\n",(0,t.jsx)(s.h2,{id:"reasons-to-use-leadworker",children:"Reasons to Use Lead/Worker"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Lower your costs"})," by using cheaper models for routine execution"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Speed things up"})," while still getting solid plans from more capable models"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Mix and match providers"})," (e.g., Claude for reasoning, OpenAI for execution)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Handle long dev sessions"})," without worrying about model fatigue or performance"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(s.p,{children:"If you're just getting started, the default settings will work fine. But here's how to tune things:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Bump up ",(0,t.jsx)(s.code,{children:"GOOSE_LEAD_TURNS"})," to 5\u20137 for heavier planning upfront"]}),"\n",(0,t.jsxs)(s.li,{children:["Lower ",(0,t.jsx)(s.code,{children:"GOOSE_LEAD_FAILURE_THRESHOLD"})," to 1 if you want Goose to correct issues quickly"]}),"\n",(0,t.jsx)(s.li,{children:"Choose a fast, lightweight worker model (Claude Haiku, GPT-4o-mini) for day-to-day tasks"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"For debugging, you can see model switching behavior by turning on this log:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"export RUST_LOG=goose::providers::lead_worker=info\n"})}),"\n",(0,t.jsx)(s.h2,{id:"planning-mode-compatibility",children:"Planning Mode Compatibility"}),"\n",(0,t.jsxs)(s.p,{children:["Lead/worker mode also works alongside Goose's ",(0,t.jsx)(s.code,{children:"/plan"})," command. You can even assign separate models for each:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'export GOOSE_LEAD_MODEL="o1-preview"        # used automatically\nexport GOOSE_PLANNER_MODEL="gpt-4o"         # used when you explicitly call /plan\nexport GOOSE_MODEL="gpt-4o-mini"            # used for execution\n'})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"The lead/worker model helps you work smarter with Goose. You get high quality reasoning when it matters and save time and money on execution. And with the fallback system in place, you don't have to babysit it. It just works."})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>a});var o=n(96540);const t={},r=o.createContext(t);function i(e){const s=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(r.Provider,{value:s},e.children)}}}]);